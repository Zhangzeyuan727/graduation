{"remainingRequest":"/Users/zzy/Desktop/zzy/node_modules/_vue-loader@15.4.2@vue-loader/lib/index.js??vue-loader-options!/Users/zzy/Desktop/zzy/src/views/search/search.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zzy/Desktop/zzy/src/views/search/search.vue","mtime":1543988579000},{"path":"/Users/zzy/Desktop/zzy/node_modules/_cache-loader@1.2.5@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zzy/Desktop/zzy/node_modules/_babel-loader@8.0.4@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zzy/Desktop/zzy/node_modules/_cache-loader@1.2.5@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zzy/Desktop/zzy/node_modules/_vue-loader@15.4.2@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: \"home\",\n  // el: '#demo',\n  data() {\n    return {\n      keyword: \"\",\n      activeName: \"first\",\n      //现实搜索类别页面\n      showSearchType: false,\n      //历史搜索记录\n      historyList: [],\n      //显示历史记录\n      showHistory: true,\n      book: []\n    };\n  },\n  created() {\n    if (this.$store.state.showTab) {\n      this.$store.commit(\"change\");\n    }\n    let historyBooks = JSON.parse(localStorage.getItem(\"historySearch\"));\n    if (historyBooks) {\n      this.historyList = historyBooks;\n    }\n  },\n  watch: {\n    keyword(val) {\n      if (val.replace(/\\s*/g, \"\")) {\n        this.showSearchType = true;\n      } else {\n        this.showSearchType = false;\n        let historyBooks = JSON.parse(localStorage.getItem(\"historySearch\"));\n        if (historyBooks) {\n          this.historyList = historyBooks;\n        }\n        this.showHistory = true;\n      }\n    }\n  },\n  components: {},\n  methods: {\n    //搜索图书\n    goSearch(type) {\n      this.showSearchType = false;\n      this.showHistory = false;\n      this.book = [];\n      this.$http\n        .searchBook(`pagination=false&keyname=${type}&keyvalue=${this.keyword}`)\n        .then(res => {\n          if (res.data.statusCode == 1) {\n            if (res.data.results && res.data.results.length > 0) {\n              this.book.push(...res.data.results);\n            }\n          }\n        });\n      //将搜索记录保存在本地\n      let historyBooks = JSON.parse(localStorage.getItem(\"historySearch\"));\n      if (historyBooks && historyBooks.length > 0) {\n        //判断历史记录里是否有该关键字\n        if (historyBooks.indexOf(this.keyword) != -1) {\n          let index = historyBooks.findIndex(item => item === this.keyword);\n          historyBooks.splice(index, 1);\n          historyBooks.unshift(this.keyword);\n          localStorage.setItem(\"historySearch\", JSON.stringify(historyBooks));\n        } else {\n          historyBooks.unshift(this.keyword);\n          localStorage.setItem(\"historySearch\", JSON.stringify(historyBooks));\n        }\n      } else {\n        this.historyList.unshift(this.keyword);\n        localStorage.setItem(\"historySearch\", JSON.stringify(this.historyList));\n      }\n    },\n    //删除搜索记录\n    deleteBtn() {\n      this.historyList = [];\n      localStorage.removeItem(\"historySearch\");\n    },\n    goSelect(e) {\n      this.keyword = e;\n    },\n    goDetail(e) {\n      localStorage.setItem('bookDetailId',e);\n      this.$router.push({\n        path: \"/bookDetail\"\n      });\n    },\n    close() {\n      this.$router.go(-1);\n    }\n  }\n};\n",{"version":3,"sources":["search.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"search.vue","sourceRoot":"src/views/search","sourcesContent":["<template>\n  <div id=\"search\">\n    <div class=\"header\">\n      <i @click=\"close\" class=\"iconfont icon-25\"></i>\n      <div style=\"width:100%;margin-right:20px\">\n        <el-input placeholder=\"请输入内容\" v-model=\"keyword\" class=\"input-with-select\">\n          <el-button slot=\"append\" icon=\"el-icon-search\"></el-button>\n        </el-input>\n      </div>\n    </div>\n    <div class=\"content\">\n      <template v-if=\"showHistory&&!showSearchType\">\n        <div class=\"historySearchTop\">\n          <span>历史搜索记录</span>\n          <span @click=\"deleteBtn\">删除</span>\n        </div>\n        <div>\n          <div\n            v-for=\"(item,index) in historyList\"\n            :key=\"index\"\n            class=\"historySearchContent\"\n            @click=\"goSelect(item)\"\n          >{{item}}</div>\n        </div>\n      </template>\n      <template v-if=\"showSearchType\">\n        <div class=\"searchType\" @click=\"goSearch('name')\">\n          <i class=\"iconfont icon-search\"></i>\n          <div class=\"type\">按书名搜索:</div>\n          <div class=\"keyWord\">{{keyword}}</div>\n        </div>\n        <div class=\"searchType\" @click=\"goSearch('author')\">\n          <i class=\"iconfont icon-search\"></i>\n          <div class=\"type\">按作者搜索:</div>\n          <div class=\"keyWord\">{{keyword}}</div>\n        </div>\n        <div class=\"searchType\" @click=\"goSearch('isbn')\">\n          <i class=\"iconfont icon-search\"></i>\n          <div class=\"type\">按ISBN搜索:</div>\n          <div class=\"keyWord\">{{keyword}}</div>\n        </div>\n      </template>\n      <div v-if=\"!showSearchType&&!showHistory\">\n        <div v-for=\"item in book\" :key=\"item.id\" class=\"searchBook\" @click=\"goDetail(item.id)\">\n          <img src=\"../../assets/bookImg/book-1.jpg\" alt>\n          <div class=\"searchBookContent\">\n            <span>{{item.name}}</span>\n            <span>{{item.price}}</span>\n            <span>{{item.publishingFirm}}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"home\",\n  // el: '#demo',\n  data() {\n    return {\n      keyword: \"\",\n      activeName: \"first\",\n      //现实搜索类别页面\n      showSearchType: false,\n      //历史搜索记录\n      historyList: [],\n      //显示历史记录\n      showHistory: true,\n      book: []\n    };\n  },\n  created() {\n    if (this.$store.state.showTab) {\n      this.$store.commit(\"change\");\n    }\n    let historyBooks = JSON.parse(localStorage.getItem(\"historySearch\"));\n    if (historyBooks) {\n      this.historyList = historyBooks;\n    }\n  },\n  watch: {\n    keyword(val) {\n      if (val.replace(/\\s*/g, \"\")) {\n        this.showSearchType = true;\n      } else {\n        this.showSearchType = false;\n        let historyBooks = JSON.parse(localStorage.getItem(\"historySearch\"));\n        if (historyBooks) {\n          this.historyList = historyBooks;\n        }\n        this.showHistory = true;\n      }\n    }\n  },\n  components: {},\n  methods: {\n    //搜索图书\n    goSearch(type) {\n      this.showSearchType = false;\n      this.showHistory = false;\n      this.book = [];\n      this.$http\n        .searchBook(`pagination=false&keyname=${type}&keyvalue=${this.keyword}`)\n        .then(res => {\n          if (res.data.statusCode == 1) {\n            if (res.data.results && res.data.results.length > 0) {\n              this.book.push(...res.data.results);\n            }\n          }\n        });\n      //将搜索记录保存在本地\n      let historyBooks = JSON.parse(localStorage.getItem(\"historySearch\"));\n      if (historyBooks && historyBooks.length > 0) {\n        //判断历史记录里是否有该关键字\n        if (historyBooks.indexOf(this.keyword) != -1) {\n          let index = historyBooks.findIndex(item => item === this.keyword);\n          historyBooks.splice(index, 1);\n          historyBooks.unshift(this.keyword);\n          localStorage.setItem(\"historySearch\", JSON.stringify(historyBooks));\n        } else {\n          historyBooks.unshift(this.keyword);\n          localStorage.setItem(\"historySearch\", JSON.stringify(historyBooks));\n        }\n      } else {\n        this.historyList.unshift(this.keyword);\n        localStorage.setItem(\"historySearch\", JSON.stringify(this.historyList));\n      }\n    },\n    //删除搜索记录\n    deleteBtn() {\n      this.historyList = [];\n      localStorage.removeItem(\"historySearch\");\n    },\n    goSelect(e) {\n      this.keyword = e;\n    },\n    goDetail(e) {\n      localStorage.setItem('bookDetailId',e);\n      this.$router.push({\n        path: \"/bookDetail\"\n      });\n    },\n    close() {\n      this.$router.go(-1);\n    }\n  }\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style lang=\"scss\">\n#search {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0px;\n  overflow: hidden;\n  background-color: #fff;\n  .header {\n    display: flex;\n    align-items: center;\n    width: 100%;\n    height: 48px;\n    background-color: #bbd2c2;\n    color: white;\n  }\n\n  .icon-25 {\n    font-size: 20px;\n    padding: 0 12px;\n  }\n\n  .el-input {\n    width: 94%;\n  }\n\n  .el-input__inner {\n    height: 30px;\n    border: none;\n    text-align: center;\n  }\n\n  .el-input-group__append {\n    background-color: white;\n    border: none;\n  }\n\n  .el-button {\n    padding: 12px;\n  }\n\n  .el-icon-search {\n    color: #bbd2c2;\n  }\n\n  .el-input-group__prepend {\n    background-color: #fff;\n  }\n\n  .content {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 48px;\n    bottom: 0px;\n    overflow-x: hidden;\n    overflow-y: scroll;\n    .historySearchTop {\n      height: 6vh;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      span {\n        font-size: 14px;\n      }\n    }\n    .historySearchContent {\n      padding: 3px 15px;\n      border: 1px solid #ccc;\n      border-radius: 50px;\n      display: inline-block;\n    }\n    .searchType {\n      height: 10vh;\n      display: flex;\n      align-items: center;\n      margin-left: 10vw;\n      box-sizing: border-box;\n      border-bottom: 1px solid #ccc;\n      > i {\n        font-size: 20px;\n        display: block;\n        width: 20px;\n        height: 20px;\n      }\n      .type {\n        width: 80px;\n        font-size: 13px;\n      }\n      .keyWord {\n        width: calc(100% - 100px);\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n      }\n    }\n    .searchBook {\n      display: flex;\n      align-items: center;\n      height: 15vh;\n      margin: 15px 10px;\n      > img {\n        height: 80%;\n        margin-right: 20px;\n      }\n      .searchBookContent {\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n      }\n    }\n  }\n}\n</style>\n"]}]}